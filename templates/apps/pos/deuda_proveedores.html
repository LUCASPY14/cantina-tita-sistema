{% extends "base.html" %}
{% load humanize %}

{% block title %}Deuda con Proveedores{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <div class="mb-6">
        <a href="{% url 'pos:compras_dashboard' %}" class="btn btn-ghost btn-sm mb-2">‚Üê Volver</a>
        <h1 class="text-3xl font-bold text-neutral">üí∞ Deuda con Proveedores</h1>
    </div>

    <div class="alert alert-warning shadow-lg mb-6">
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current flex-shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
            <div>
                <h3 class="font-bold">Deuda Total</h3>
                <div class="text-2xl font-mono">Gs. {{ total_deuda|floatformat:0|intcomma }}</div>
            </div>
        </div>
    </div>

    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-4">Detalle por Proveedor</h2>
            <div class="overflow-x-auto">
                <table class="table table-zebra w-full">
                    <thead>
                        <tr class="bg-neutral text-neutral-content">
                            <th>Proveedor</th>
                            <th>√öltima Compra</th>
                            <th>Saldo Pendiente</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for deuda in deudas %}
                        <tr>
                            <td class="font-bold">{{ deuda.id_proveedor.razon_social }}</td>
                            <td>{{ deuda.ultima_compra|date:"d/m/Y"|default:"-" }}</td>
                            <td class="font-mono text-lg text-error">Gs. {{ deuda.saldo|floatformat:0|intcomma }}</td>
                            <td>
                                <a href="{% url 'pos:proveedor_detalle' deuda.id_proveedor.id_proveedor %}" class="btn btn-sm btn-ghost">Ver Detalle</a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr><td colspan="4" class="text-center text-neutral/50">No hay deudas pendientes</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}
